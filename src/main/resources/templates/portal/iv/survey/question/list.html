<!DOCTYPE html>
<html
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{portal/layout/iv/hq/parts/common/index}">
<th:block layout:fragment="content">
	
	<div class="condition-area">
	<table class="condition table-fixed">
		<tr>
			<td style="width:300px;">설문제목</td>
			<td>[[${survey?.title}]]</td>
		</tr>
		<tr>
			<td>설문시작일</td>
			<td>[[${survey?.validFrom}]] ~ [[${survey?.validTo}]]</td>
		</tr>
	</table>	
	</div>
	
	<div class="grid-info">
		<div class="block-button-area">
			<button id="BTN_write" type="button">문항등록</button>
		</div>
		<div class="grid-total">
			<div class="split"></div>
			<span class="total-number" id="totalRows"></span>
		</div>
	</div>
	
	<div id="AREA_grid" class="flex-grow grid-area">
		<table id="TBL_grid" class="order-column stripe compact"></table>
	</div>

<script>
let $tableObj;
$(function(){
	
	$tableObj = $("#TBL_grid").DataTable({
		select: {
			selector: "td:not(.noselect)"
	    },
		ordering: true, 
		scrollY: 100,
		columns : [
			{data:"sqSeq", 		title: "번호",		"width": "5%"},
			{data:"title",		title: "질문", 		"width": "8%"},
			{data:"validFrom",	title: "문항(다중)", 	"width": "15%"},
			{data:"validTo",	title: "옵션", 		"width": "15%"},
			{data:"title", 		title: "보기수"},
			{data:null, 		title: "비고", 		"width": "10%"}
		],
		columnDefs: [
		],
		
		ajax: {
			url: "[[${BASE_PATH}]]/survey/question/list/data",
			data: function(p)
			{
				p.sSeq 		= "[[${survey?.sSeq}]]";
			},
			dataSrc: function(response) 
			{
				let result = response.RESULT;

				$("#totalRows").html(JpUtilsNumber.addComma(result.length) + " row(s).");

				return result;
			}
		},
		paging : false, // 페이징 기능켬
		//pageLength: 20, // 한 페이지에 20개 행
		initComplete:function(settings, json)
		{
			ProgressBar.hide();
			//this.api().page(2).draw("page");
		}
	});
	
	initGridTable($tableObj);
	
	
	$("#BTN_write").on("click", function(){
		Popup.open("[[${BASE_PATH}]]/survey/question/write?sSeq=[[${survey?.sSeq}]]", 1100, 600);
	});
});

function goView(sSeq) {
	
	document.location.href = "[[${BASE_PATH}]]/survey/view?sSeq="+sSeq;
	/* $("#FORM_search").attr("action", "[[${BASE_PATH}]]/survey/view");
	$("#FORM_search").submit(); */
}

</script>
</th:block>	