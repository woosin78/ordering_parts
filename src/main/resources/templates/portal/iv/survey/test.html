<!DOCTYPE html>
<html
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{portal/layout/iv/hq/parts/common/index}">

<th:block layout:fragment="content">
	
	<div class="block-header">
		<div class="block-title" th:text="test"></div>
	</div>	
	
	<div class="condition-area">
		<a href="javascript:Survey.popupVote();" id="surveyTitle"></a>
	</div>
	
	<script>
	let Survey = {
		sSeq: 0,
		getLatestSurvey: function() {
			let targetCode = '0001031780';
			let options = {
				url: "[[${BASE_PATH}]]/survey/latest",
				data: {targetCode:targetCode},
				success: function(data) {
					let survey = data.RESULT;
					Survey.sSeq = survey.sseq;
					$("#surveyTitle").text(survey.title);				
					//console.log(survey.sseq + ' , ' + survey.title);
				},
				error: function(jqXHR, textStatus, errorThrown) {
					console.log(textStatus);
					console.log(errorThrown);
				}
			};
			
			JpUtilsAjax.post(options);
		},
		popupVote: function() {
			if (this.sSeq == 0) {
				return;
			}
			Popup.open("[[${BASE_PATH}]]/survey/popup/vote?sSeq="+this.sSeq, 700, 700);
		}
	}
	
	function callbackAfterVote() {
		document.location.href = "[[${BASE_PATH}]]/survey/list";
	}
	
	$(window).on("load", function() {
		ProgressBar.hide();
		
		Survey.getLatestSurvey();
	});
	
	</script>
</th:block>								