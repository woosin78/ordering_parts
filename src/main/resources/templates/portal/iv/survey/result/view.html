<!DOCTYPE html>
<html
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{portal/layout/iv/hq/parts/popup/index}">
<th:block layout:fragment="content">
	
	<div class="block-header" >
		<div class="block-title" th:text="#{HQP_L_SURVEY_VIEW_RESULT}"></div>
		<div class="block-button-area">
			<button type="button" th:text="#{HQP_B_CLOSE}" onclick="window.close();"></button>
		</div>
	</div>	
	
	<div class="condition-area">
		<table class="condition table-fixed">
			<tr>
				<th style="width:20%;"><span th:text="#{HQP_L_TITLE}"></span></th>
				<td><span th:text="${survey?.title}" /></td>
			</tr>
			<tr th:style="${survey?.description == null ? 'display:none' : ''}">
				<th><span th:text="#{HQP_L_PURPOSE}"></span></th>
				<td><span th:text="${survey?.description}"/></td>
			</tr>
			<tr th:style="${#lists.isEmpty(survey?.uploadFileLists) ? 'display:none' : ''}">
				<th><span th:text="#{HQP_L_ATTACHMENT}"></span></th>
				<td>
					<span th:each="uploadFileList : ${survey?.uploadFileLists}">
					<a class="link" th:text="${uploadFileList.fullOriginName}" th:downloadKey="${uploadFileList.downloadKey}"></a>
					(<span th:text="${uploadFileList.displayFileSize}"></span>)
					</span>
				</td>
			</tr>
		</table>
		<br/>
		<table class="condition">
			<tbody>
				<tr th:each="voteItem, rowIndex : ${voteResult}">
					<td th:switch="${voteItem.type}">
						
						<!--  객관식 -->
						<table th:case="0" style="width:100%">
							<tr>
								<td>
									<table>
										<tr>
											<td>
												<span th:text="${rowIndex.count}+'.'"></span>
												<span th:text="${voteItem.title}"></span>
												<span>([[#{HQP_L_OBJECTIVE_QUESTION}]])</span>
											</td>
										</tr>
									</table>
									<table style="width:100%">
										<tbody th:each="item, index : ${voteItem.items}">
											<tr>
												<td>
													<span>([[${index.count}]])  [[${item.title}]]
												</td>
											</tr>
											<tr>
												<td style="color:#cc6600; font-weight:bold; font-size:1em;">
													<img th:src="'https://doobiz-edu.doosan-iv.com/common/images/common/common/graph_'+${rowIndex.count}+'.gif'" height="12"
														th:width="${#numbers.formatDecimal((item.voteCnt*100)/voteItem.voteCnt, 0, 0)}+'%'"> 
														[[${item.voteCnt}]] ([[${#numbers.formatDecimal((item.voteCnt*100)/voteItem.voteCnt, 0, 0)}]]%)
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</table>
						
						<!--  다중객관식 -->
						<table th:case="1" style="width:100%">
							<tr>
								<td>
									<table>
										<tr>
											<td>
												<span th:text="${rowIndex.count}+'.'"></span>
												<span th:text="${voteItem.title}"></span>
												<span>([[#{HQP_L_SELECTION_NUMBER}]] : [[${voteItem.mandatoryCnt}]])</span>
											</td>
										</tr>
									</table>
									<table style="width:100%">
										<tbody th:each="item, index : ${voteItem.items}">
											<tr>
												<td>
													<span>([[${index.count}]])  [[${item.title}]]
												</td>
											</tr>
											<tr>
												<td style="color:#cc6600; font-weight:bold; font-size:1em;">
													<img th:src="'https://doobiz-edu.doosan-iv.com/common/images/common/common/graph_'+${rowIndex.count}+'.gif'" height="12"
														th:width="${#numbers.formatDecimal((item.voteCnt*100)/voteItem.voteCnt, 0, 0)}+'%'"> 
														[[${item.voteCnt}]] ([[${#numbers.formatDecimal((item.voteCnt*100)/voteItem.voteCnt, 0, 0)}]]%) 
												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</table>
						
						<!--  주관식 -->
						<table th:case="2">
							<tr>
								<td>
									<table>
										<tr>
											<td>
												<span th:text="${rowIndex.count}+'.'"></span>
												<span th:text="${voteItem.title}"></span>
												<span>([[#{HQP_L_SUBJECTIVE_QUESTION}]])</span>
											</td>
										</tr>
									</table>
									<table>
										<tr>
											<td>
												<button class="small_button" th:onclick="goTextAnswers([[${voteItem.sSeq}]], [[${voteItem.sqSeq}]], [[${rowIndex.count}]]);">[[#{HQP_B_VIEW_ANSWERS}]]</button>
											</td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
						
						<!--  가중치 -->
						<table th:case="3" style="width:100%">
							<tr> 
								<td>
									<table>
										<tr>
											<td>
												<span th:text="${rowIndex.count}+'.'"></span>
												<span th:text="${voteItem.title}"></span>
												<span>([[#{HQP_L_EXTRA_WEIGHT_SUM}]] : 10[[#{HQP_L_POINT}]])</span>
											</td>
										</tr>
									</table>
									<table>
										<tbody th:each="item, index : ${voteItem.items}">
											<tr>
												<td>
													<span>([[${index.count}]])  [[${item.title}]]</span>
												</td>
											</tr>
											<tr>
												<td style="color:#cc6600; font-weight:bold; font-size:1em;">[[${item.resultTxt}]]</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</table>
						
						<!--  우선순위 -->
						<table th:case="4">
							<tr>
								<td>
									<table>
										<tr>
											<td>
												<span th:text="${rowIndex.count}+'.'"></span>
												<span th:text="${voteItem.title}"></span>
												<span>([[#{HQP_L_PRIORITY}]])</span>
											</td>
										</tr>
									</table>
									<table>
										<tbody th:each="item, index : ${voteItem.items}">
											<tr>
												<td>
													<span>([[${index.count}]])  [[${item.title}]]</span>
												</td>
											</tr>
											<tr>
												<td style="color:#cc6600; font-weight:bold; font-size:1em;">[[${item.resultTxt}]]</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</table>
						
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	
<script>
$(function(){
	ProgressBar.hide();
	
	$("a[downloadKey]").on("click", function() {					
		PortalFileDownload.download($(this).attr("downloadKey"));
	});	
});

function goTextAnswers(sSeq, sqSeq, rowIndex) {
	location.href="[[${BASE_PATH}]]/survey/result/textAnswers?sSeq="+sSeq+"&sqSeq="+sqSeq+"&rowIndex="+rowIndex;
}

</script>
</th:block>	