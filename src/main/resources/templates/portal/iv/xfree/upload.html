<!DOCTYPE html>
<html
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<script th:src="@{/portal/js/jquery/jquery.min.js}"></script>

<script>
window.onload = function()
{
	let error = "[[${xfreeUpload.error}]]";
	
	if (error != null && error.length > 0)
	{
		alert(error);
		return;		
	};
	
	let rootId = "[[${xfreeUpload.rootId}]]";
	let savedFileName = "[[${xfreeUpload.savedFileName}]]";
	let origin = document.location.origin;
	let viewerPath = "[[${xfreeUpload.viewerPath}]]";	

	let savedFilePath = "";

	if (origin)
	{
		viewerPath = origin + viewerPath;
		savedFilePath = viewerPath + "?fileName=" + savedFileName;
	}
	else
	{
		//origin 이 없을 경우 프로토콜과 호스트를 결합하여 url 경로 설정.
		//viewerPath = document.location.protocol + '//' + document.location.host + viewerPath;
		savedFilePath = viewerPath + "?fileName=" + savedFileName;
	};

	if (savedFilePath != undefined && savedFilePath != "")
	{
		let str = '<img src="' + savedFilePath + '" />';
		let range = null;

		if (parent._xfe_object[rootId].xfeStackObject.xfeFocusoutRange)
		{
			range = parent._xfe_object[rootId].xfeStackObject.xfeFocusoutRange;
		}
		else
		{
			if (parent.xfeBrowserFlag.isIE()){
				if (parent.xfeBrowserFlag.getBrowserVersion() < 11)
				{
					if (parent._xfe_object[rootId].xfeStackObject.xfeDocument.selection)
					{
						range = parent._xfe_object[rootId].xfeStackObject.xfeDocument.selection.createRange();
					}
					else
					{
						range = parent._xfe_object[rootId].xfeStackObject.xfeSavedLastRange;
					}
				}
				else
				{
					if (parent._xfe_object[rootId].xfeRangeHandler.getDesignDocumentSelection().rangeCount > 0)
					{
						range = parent._xfe_object[rootId].xfeRangeHandler.getDesignDocumentSelection().getRangeAt(0);
					}
					else
					{
						range = parent._xfe_object[rootId].xfeStackObject.xfeSavedLastRange;
					}
				}
			}
			else
			{
				if (parent._xfe_object[rootId].xfeStackObject.xfeDocument.getSelection)
				{
					if (parent._xfe_object[rootId].xfeRangeHandler.getDesignDocumentSelection().rangeCount > 0)
					{
						range = parent._xfe_object[rootId].xfeRangeHandler.getDesignDocumentSelection().getRangeAt(0);
					}
					else
					{
						range = parent._xfe_object[rootId].xfeStackObject.xfeSavedLastRange;
					}
				}
			}
		}
		parent._xfe_object[rootId].xfeContentsHandler.insertHTML(str, range);
	}
};
</script>
</html>