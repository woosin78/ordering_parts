<!DOCTYPE html>
<html
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{portal/layout/iv/hq/parts/popup/index}">

<th:block layout:fragment="content">
	<div class="block-header">
		<div class="block-title" th:text="#{HQP_T_SIMULATION_ERROR REPORT}"></div>
		<div class="block-button-area">
			<button id="BTN_download" type="button">[[#{HQP_B_DOWNLOAD}]]</button>
		</div>		
	</div>
	
	<div id="AREA_grid" class="flex-grow grid-area">
		<table id="TBL_grid" class="order-column stripe compact"></table>
	</div>
	
	<script>
	$(function(){
		try
		{
			$("#totalRows").html(JpUtilsNumber.addComma(opener.errorOrderItems.length) + " row(s).");			
		}
		catch (e) {}
		
		$tableObj = $("#TBL_grid").DataTable({
			ordering: false,// 정렬 기능 켬
			scrollY: 100,
			columns : [
				{name: "materialNo", data: "materialNo", title: "[[#{HQP_L_ORDER_PART_NO}]]"},//Parts No.
				{
					name: "duplicate",
					title: "[[#{HQP_L_SIMULATION_DUPLICATE_MATERIAL}]]",
					render: function(data, type, row)
					{
						return (row.errorType == "DUPL_MATNR") ? "X" : "";
					}
				},				
				{
					name: "nonExist",
					title: "[[#{HQP_L_SIMULATION_ERROR_NOT_EXIST}]]",
					render: function(data, type, row)
					{
						return (row.errorType == "NON_EXIST") ? "X" : "";
					}
				},
				{
					name: "nonPrice",
					title: "[[#{HQP_L_SIMULATION_ERROR_NOT_PRICE}]]",
					render: function(data, type, row)
					{
						return (row.errorType == "NON_PRICE") ? "X" : "";
					}
				},
				{
					name: "nonPurchase",
					title: "[[#{HQP_L_SIMULATION_ERROR_NOT_SERVICEABLE}]]",
					render: function(data, type, row)
					{
						return (row.errorType == "NON_PURCHASE") ? "X" : "";
					}
				},
				{
					name: "hazard",
					title: "[[#{HQP_L_SIMULATION_ERROR_HAZARD}]]",
					render: function(data, type, row)
					{
						return (row.errorType == "HAZARD_MATNR") ? "X" : "";
					}
				},
				{name: "errorCode", data: "errorCode", title: "[[#{HQP_L_SIMULATION_ERROR_CODE}]]"},//Error Code
				{name: "errorMessage", data: "errorMessage", title: "[[#{HQP_L_SIMULATION_ERROR_MSG}]]"}//Text	
			],
			data: opener.errorOrderItems,
			columnDefs: [
				{targets: [1, 2, 3, 4, 5, 6, 7], className: "dt-body-center"}
			],			
    		initComplete: function() {
    			ProgressBar.hide();
    		}
		});	
		
		// Datatable grid 초기 설정 셋업
		initGridTable($tableObj);
	});
	
	$("#BTN_download").on("click", function() {
		_gridDownload($tableObj, "Error_Report");
	});	
	</script>	
</th:block>